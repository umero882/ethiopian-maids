var C={"Content-Type":"application/json"},H=/\{[^{}]+\}/g,A=class extends Request{constructor(t,e){super(t,e);for(let r in e)r in this||(this[r]=e[r])}};function D(o){let{baseUrl:t="",fetch:e=globalThis.fetch,querySerializer:r,bodySerializer:n,headers:s,...a}={...o};t.endsWith("/")&&(t=t.substring(0,t.length-1)),s=z(C,s);let c=[];async function u(l,i){let{fetch:m=e,headers:P,params:b={},parseAs:j="json",querySerializer:w,bodySerializer:S=n??L,...U}=i||{},x=typeof r=="function"?r:T(r);w&&(x=typeof w=="function"?w:T({...typeof r=="object"?r:{},...w}));let p={redirect:"follow",...a,...U,headers:z(s,P,b.header)};p.body&&(p.body=S(p.body)),p.body instanceof FormData&&p.headers.delete("Content-Type");let d=new A(k(l,{baseUrl:t,params:b,querySerializer:x}),p),E={baseUrl:t,fetch:m,parseAs:j,querySerializer:x,bodySerializer:S};for(let y of c)if(y&&typeof y=="object"&&typeof y.onRequest=="function"){d.schemaPath=l,d.params=b;let h=await y.onRequest(d,E);if(h){if(!(h instanceof Request))throw new Error("Middleware must return new Request() when modifying the request");d=h}}let f=await m(d);for(let y=c.length-1;y>=0;y--){let h=c[y];if(h&&typeof h=="object"&&typeof h.onResponse=="function"){d.schemaPath=l,d.params=b;let g=await h.onResponse(f,E,d);if(g){if(!(g instanceof Response))throw new Error("Middleware must return new Response() when modifying the response");f=g}}}if(f.status===204||f.headers.get("Content-Length")==="0")return f.ok?{data:{},response:f}:{error:{},response:f};if(f.ok)return j==="stream"?{data:f.body,response:f}:{data:await f[j](),response:f};let $=await f.text();try{$=JSON.parse($)}catch{}return{error:$,response:f}}return{async GET(l,i){return u(l,{...i,method:"GET"})},async PUT(l,i){return u(l,{...i,method:"PUT"})},async POST(l,i){return u(l,{...i,method:"POST"})},async DELETE(l,i){return u(l,{...i,method:"DELETE"})},async OPTIONS(l,i){return u(l,{...i,method:"OPTIONS"})},async HEAD(l,i){return u(l,{...i,method:"HEAD"})},async PATCH(l,i){return u(l,{...i,method:"PATCH"})},async TRACE(l,i){return u(l,{...i,method:"TRACE"})},use(...l){for(let i of l)if(i){if(typeof i!="object"||!("onRequest"in i||"onResponse"in i))throw new Error("Middleware must be an object with one of `onRequest()` or `onResponse()`");c.push(i)}},eject(...l){for(let i of l){let m=c.indexOf(i);m!==-1&&c.splice(m,1)}}}}function R(o,t,e){if(t==null)return"";if(typeof t=="object")throw new Error("Deeply-nested arrays/objects aren\u2019t supported. Provide your own `querySerializer()` to handle these.");return`${o}=${e?.allowReserved===!0?t:encodeURIComponent(t)}`}function O(o,t,e){if(!t||typeof t!="object")return"";let r=[],n={simple:",",label:".",matrix:";"}[e.style]||"&";if(e.style!=="deepObject"&&e.explode===!1){for(let c in t)r.push(c,e.allowReserved===!0?t[c]:encodeURIComponent(t[c]));let a=r.join(",");switch(e.style){case"form":return`${o}=${a}`;case"label":return`.${a}`;case"matrix":return`;${o}=${a}`;default:return a}}for(let a in t){let c=e.style==="deepObject"?`${o}[${a}]`:a;r.push(R(c,t[a],e))}let s=r.join(n);return e.style==="label"||e.style==="matrix"?`${n}${s}`:s}function q(o,t,e){if(!Array.isArray(t))return"";if(e.explode===!1){let s={form:",",spaceDelimited:"%20",pipeDelimited:"|"}[e.style]||",",a=(e.allowReserved===!0?t:t.map(c=>encodeURIComponent(c))).join(s);switch(e.style){case"simple":return a;case"label":return`.${a}`;case"matrix":return`;${o}=${a}`;default:return`${o}=${a}`}}let r={simple:",",label:".",matrix:";"}[e.style]||"&",n=[];for(let s of t)e.style==="simple"||e.style==="label"?n.push(e.allowReserved===!0?s:encodeURIComponent(s)):n.push(R(o,s,e));return e.style==="label"||e.style==="matrix"?`${r}${n.join(r)}`:n.join(r)}function T(o){return function(e){let r=[];if(e&&typeof e=="object")for(let n in e){let s=e[n];if(s!=null){if(Array.isArray(s)){r.push(q(n,s,{style:"form",explode:!0,...o?.array,allowReserved:o?.allowReserved||!1}));continue}if(typeof s=="object"){r.push(O(n,s,{style:"deepObject",explode:!0,...o?.object,allowReserved:o?.allowReserved||!1}));continue}r.push(R(n,s,o))}}return r.join("&")}}function I(o,t){let e=o;for(let r of o.match(H)??[]){let n=r.substring(1,r.length-1),s=!1,a="simple";if(n.endsWith("*")&&(s=!0,n=n.substring(0,n.length-1)),n.startsWith(".")?(a="label",n=n.substring(1)):n.startsWith(";")&&(a="matrix",n=n.substring(1)),!t||t[n]===void 0||t[n]===null)continue;let c=t[n];if(Array.isArray(c)){e=e.replace(r,q(n,c,{style:a,explode:s}));continue}if(typeof c=="object"){e=e.replace(r,O(n,c,{style:a,explode:s}));continue}if(a==="matrix"){e=e.replace(r,`;${R(n,c)}`);continue}e=e.replace(r,a==="label"?`.${c}`:c)}return e}function L(o){return JSON.stringify(o)}function k(o,t){let e=`${t.baseUrl}${o}`;t.params?.path&&(e=I(e,t.params.path));let r=t.querySerializer(t.params.query??{});return r.startsWith("?")&&(r=r.substring(1)),r&&(e+=`?${r}`),e}function z(...o){let t=new Headers;for(let e of o){if(!e||typeof e!="object")continue;let r=e instanceof Headers?e.entries():Object.entries(e);for(let[n,s]of r)if(s===null)t.delete(n);else if(Array.isArray(s))for(let a of s)t.append(n,a);else s!==void 0&&t.set(n,s)}return t}export{k as createFinalURL,T as createQuerySerializer,D as default,L as defaultBodySerializer,I as defaultPathSerializer,z as mergeHeaders,q as serializeArrayParam,O as serializeObjectParam,R as serializePrimitiveParam};
