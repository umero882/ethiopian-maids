-- Insert sample agency jobs for testing
-- Note: Replace 'YOUR_AGENCY_USER_ID' with your actual agency user ID

-- Get the first agency user ID (or use a specific one)
DO $$
DECLARE
    v_agency_id UUID;
BEGIN
    -- Try to get an agency user
    SELECT id INTO v_agency_id
    FROM profiles
    WHERE user_type = 'agency'
    LIMIT 1;

    -- If no agency found, create a test notice
    IF v_agency_id IS NULL THEN
        RAISE NOTICE 'No agency user found. Please create an agency user first.';
        RETURN;
    END IF;

    RAISE NOTICE 'Using agency ID: %', v_agency_id;

    -- Insert sample jobs
    INSERT INTO agency_jobs (
        agency_id,
        title,
        description,
        location,
        salary_min,
        salary_max,
        currency,
        status,
        priority,
        contract_duration_months,
        working_hours,
        family_size,
        children_count,
        job_type,
        live_in_required,
        requirements,
        benefits,
        requirements_array,
        benefits_array,
        required_skills,
        required_languages,
        applicant_count,
        matched_count,
        view_count,
        posted_date,
        expires_at
    ) VALUES
    (
        v_agency_id,
        'Full-time Live-in Housekeeper',
        'Experienced housekeeper needed for a family home in Riyadh. Must have experience with childcare and cooking. The ideal candidate will be responsible for maintaining a clean and organized household while providing excellent care for two children.',
        'Riyadh, Saudi Arabia',
        1200,
        1500,
        'USD',
        'active',
        'high',
        24,
        '6 days/week, 8 hours/day',
        4,
        2,
        'live-in',
        true,
        '2+ years experience, English speaking, Childcare experience',
        'Free accommodation, Medical insurance, Annual leave',
        ARRAY['2+ years experience', 'English speaking', 'Childcare experience'],
        ARRAY['Free accommodation', 'Medical insurance', 'Annual leave'],
        ARRAY['Cooking', 'Cleaning', 'Childcare'],
        ARRAY['English', 'Arabic preferred'],
        12,
        5,
        45,
        NOW() - INTERVAL '10 days',
        NOW() + INTERVAL '20 days'
    ),
    (
        v_agency_id,
        'Part-time Elderly Care Assistant',
        'Caring and experienced assistant needed for elderly care in Dubai. Must be patient and have medical care experience. The role involves providing compassionate care and assistance with daily activities.',
        'Dubai, UAE',
        800,
        1000,
        'USD',
        'paused',
        'urgent',
        12,
        '5 days/week, 6 hours/day',
        2,
        0,
        'part-time',
        false,
        'Medical care experience, Arabic speaking preferred, 3+ years experience',
        'Transportation allowance, Medical insurance',
        ARRAY['Medical care experience', 'Arabic speaking preferred', '3+ years experience'],
        ARRAY['Transportation allowance', 'Medical insurance'],
        ARRAY['Elderly Care', 'Medical Care', 'Cooking'],
        ARRAY['English', 'Arabic'],
        8,
        3,
        32,
        NOW() - INTERVAL '15 days',
        NOW() + INTERVAL '15 days'
    ),
    (
        v_agency_id,
        'Domestic Helper with Cooking Skills',
        'Looking for a domestic helper with excellent cooking skills for a family in Kuwait. The candidate should be proficient in Middle Eastern and international cuisine.',
        'Kuwait City, Kuwait',
        1000,
        1200,
        'USD',
        'filled',
        'normal',
        36,
        '6 days/week, 9 hours/day',
        5,
        3,
        'full-time',
        true,
        'Excellent cooking skills, Housekeeping experience, English communication',
        'Free accommodation, Food allowance, Annual bonus',
        ARRAY['Excellent cooking skills', 'Housekeeping experience', 'English communication'],
        ARRAY['Free accommodation', 'Food allowance', 'Annual bonus'],
        ARRAY['Cooking', 'Cleaning', 'Laundry'],
        ARRAY['English', 'Hindi'],
        15,
        8,
        67,
        NOW() - INTERVAL '25 days',
        NOW() - INTERVAL '5 days'
    ),
    (
        v_agency_id,
        'Live-out Housekeeper',
        'Professional housekeeper needed for a modern villa in Abu Dhabi. Monday to Saturday, 8-hour shifts. Perfect for experienced housekeepers who prefer live-out arrangements.',
        'Abu Dhabi, UAE',
        900,
        1100,
        'USD',
        'active',
        'normal',
        24,
        '6 days/week, 8 hours/day',
        3,
        1,
        'live-out',
        false,
        'Professional housekeeping experience, English communication, Reliable transportation',
        'Transportation allowance, Paid vacation, End of service benefits',
        ARRAY['Professional housekeeping experience', 'English communication', 'Reliable transportation'],
        ARRAY['Transportation allowance', 'Paid vacation', 'End of service benefits'],
        ARRAY['Deep Cleaning', 'Ironing', 'Organizing'],
        ARRAY['English'],
        6,
        2,
        28,
        NOW() - INTERVAL '5 days',
        NOW() + INTERVAL '25 days'
    ),
    (
        v_agency_id,
        'Nanny for Newborn',
        'Experienced nanny needed for newborn care in Doha. Must have infant care certification and references. Live-in position with private accommodation.',
        'Doha, Qatar',
        1400,
        1600,
        'USD',
        'active',
        'urgent',
        12,
        '6 days/week, flexible hours',
        3,
        1,
        'live-in',
        true,
        'Infant care certification, 5+ years newborn experience, Excellent references',
        'Private room, Medical insurance, Annual flight ticket, Salary increase after 6 months',
        ARRAY['Infant care certification', '5+ years newborn experience', 'Excellent references'],
        ARRAY['Private room', 'Medical insurance', 'Annual flight ticket', 'Salary increase after 6 months'],
        ARRAY['Newborn Care', 'Feeding', 'Sleep Training'],
        ARRAY['English', 'Tagalog or Arabic preferred'],
        4,
        1,
        18,
        NOW() - INTERVAL '2 days',
        NOW() + INTERVAL '28 days'
    ),
    (
        v_agency_id,
        'Driver and Housekeeper Couple',
        'Looking for a married couple: husband as driver and wife as housekeeper. Both should have relevant experience. Accommodation provided.',
        'Jeddah, Saudi Arabia',
        2000,
        2500,
        'USD',
        'draft',
        'low',
        24,
        '6 days/week, 8-10 hours/day',
        6,
        4,
        'full-time',
        true,
        'Driver: Valid license, clean record. Housekeeper: Cleaning and cooking skills',
        'Furnished accommodation, Medical insurance, Annual leave',
        ARRAY['Driver: Valid license, clean record', 'Housekeeper: Cleaning and cooking skills'],
        ARRAY['Furnished accommodation', 'Medical insurance', 'Annual leave'],
        ARRAY['Driving', 'Cleaning', 'Cooking', 'Childcare'],
        ARRAY['English', 'Arabic preferred'],
        0,
        0,
        0,
        NULL,
        NULL
    );

    RAISE NOTICE 'Successfully inserted 6 sample agency jobs!';
END $$;
